<html>
<head>
  <title>yt</title>
	<link rel="stylesheet" type="text/css" href="resources/ext-all.css" />

    <!-- GC -->
 	<!-- LIBS -->
 	<script type="text/javascript" src="resources/ext-base.js"></script>
 	<!-- ENDLIBS -->

    <script type="text/javascript" src="resources/ext-all.js"></script>
    <script type="text/javascript" src="resources/ext-repl-api.js"></script>

	<style type="text/css">
	html, body {
        font:normal 12px verdana;
        margin:0;
        padding:0;
        border:0 none;
        overflow:hidden;
        height:100%;
    }
	.x-panel-body p {
	    margin:5px;
	}
    .x-column-layout-ct .x-panel {
        margin-bottom:5px;
    }
    .x-column-layout-ct .x-panel-dd-spacer {
        margin-bottom:5px;
    }
    .settings {
        background-image:url(resources/folder_wrench.png) !important;
    }
    .nav {
        background-image:url(resources/folder_go.png) !important;
    }
    #input_line {
        font-family: monospace;
    }
    </style>
	<script type="text/javascript">
    function cell_sent() {
        repl_input.get('input_line').setReadOnly(true);
    }

    function cell_finished() {
        repl_input.get('input_line').setReadOnly(false);
    }

    var handle_result = function(f, a) {
        var input_line = repl_input.get("input_line")
        if (a.result == null) {
            text = "ERROR";
        } else {
            text = a.result.replace(/\n/g,"<br/>");
        }
        Ext.get("output").dom.innerHTML +=
        '>>> ' + input_line.getValue() + '<br/>' + text + '<br/>';
        input_line.setValue("");
        cell_finished();
    }

    var repl_input = new Ext.FormPanel({
        url: 'push',
        items: [{
            id: 'input_line',
            xtype: 'textarea',
            width: '100%',
            fieldLabel: '>>>',
            name: 'line',
            allowBlank: 'True',
            bodyStyle: 'font-family: "monospace";',
            listeners: {
                specialkey: function(f, e){
                    if (e.getKey() == e.ENTER) {
                        cell_sent();
                        yt_rpc.ExtDirectREPL.execute({
                            code:repl_input.get('input_line').getValue()},
                            handle_result);
                    }
                }
            },
        },],
    });

    Ext.onReady(function(){

       // NOTE: This is an example showing simple state management. During development,
       // it is generally best to disable state management as dynamically-generated ids
       // can change across page loads, leading to unpredictable results.  The developer
       // should ensure that stable state ids are set for stateful components in real apps.
       Ext.state.Manager.setProvider(new Ext.state.CookieProvider());

       var viewport = new Ext.Viewport({
            layout:'border',
            items:[{
                region:'west',
                id:'west-panel',
                title:'West',
                split:true,
                width: 200,
                minSize: 175,
                maxSize: 400,
                collapsible: true,
                margins:'35 0 5 5',
                cmargins:'35 5 5 5',
                layout:'accordion',
                layoutConfig:{
                    animate:true
                },
                items: [{
                    html: Ext.example.shortBogusMarkup,
                    title:'Navigation',
                    autoScroll:true,
                    border:false,
                    iconCls:'nav'
                },{
                    title:'Settings',
                    html: Ext.example.shortBogusMarkup,
                    border:false,
                    autoScroll:true,
                    iconCls:'settings'
                }]
            },{
                region:'center',
                margins:'35 5 5 0',
                layout:'column',
                autoScroll:true,
                items:[{
                    columnWidth:1.0,
                    baseCls:'x-plain',
                    bodyStyle:'padding:5px 0 5px 5px; font-family: monospace;',
                    items:[{
                       title: 'Output',
                       html: "",
                       id: "output",
                    }, repl_input, ]
                },]
            }]
        });
    Ext.get("output").dom.innerHTML += 'Welcome to the yt web interface.<br/>';
    }
    
    );
	</script>
</head>
<body>
<script type="text/javascript" src="resources/examples.js"></script><!-- EXAMPLES -->
  </body>
</html>
